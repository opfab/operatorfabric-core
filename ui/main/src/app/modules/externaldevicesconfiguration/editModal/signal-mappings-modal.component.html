<!-- Copyright (c) 2024, RTE (http://www.rte-france.com)                   -->
<!-- See AUTHORS.txt                                                       -->
<!-- This Source Code Form is subject to the terms of the Mozilla Public   -->
<!-- License, v. 2.0. If a copy of the MPL was not distributed with this   -->
<!-- file, You can obtain one at http://mozilla.org/MPL/2.0/.              -->
<!-- SPDX-License-Identifier: MPL-2.0                                      -->
<!-- This file is part of the OperatorFabric project.                      -->

<div class="modal-content entity-modal">
  <div class="modal-header">
    <span class="modal-title" *ngIf="row" translate>externalDevicesConfiguration.input.edit</span>
    <span class="modal-title" *ngIf="!row" translate>externalDevicesConfiguration.input.addSignalMapping</span>
    <div id="opfab-admin-edit-btn-close" class="opfab-close-modal-icon" aria-label="Close" (click)="dismissModal('Cross click')">
      <span aria-hidden="true">&times;</span>
    </div>
  </div>
  <div class="modal-body">

    <div>
      <of-spinner *ngIf="isLoading()" loadingText="shared.loadingInProgress"></of-spinner> 

      <div *ngIf="!isLoading()">
        <form [formGroup]="signalMappingsForm" class="opfab-form-lighter">
          <div class="container">
            <div class="col">

              <div *ngIf="row" class="opfab-input opfab-edit-row">
                <label for="opfab-signalMappingId" translate>externalDevicesConfiguration.signalMapping.id</label>
                <input type="text" disabled value="{{row.id}}"/>
              </div>
              <div *ngIf="!row"  class="opfab-input opfab-edit-row">
                <label for="opfab-deviceId" translate>externalDevicesConfiguration.signalMappings.id</label>
                <input formControlName="id" name="signalMappingId" id="opfab-signalMappingId" type="text"/>
              </div>
              <div *ngIf="id.invalid" class="row alert alert-danger">
                <div *ngIf="id.errors.required" translate>admin.input.id.required</div>
                <div *ngIf="id.errors.uniqueDeviceIdViolation" translate>admin.input.id.alreadyExisting</div>
              </div>
              <div class="opfab-input opfab-edit-row">
                <label for="opfab-signal-mapping-alarm" translate>shared.severity.alarm</label>
                <input formControlName="alarm" name="alarm" id="opfab-signal-mapping-alarm" type="number"/>
              </div>
              <div *ngIf="alarm.invalid" class="row alert alert-danger">
                <div *ngIf="alarm.errors.required" translate>externalDevicesConfiguration.input.signalMapping.required</div>
              </div>
              <div class="opfab-input opfab-edit-row">
                <label for="opfab-signal-mapping-action" translate>shared.severity.action</label>
                <input formControlName="action" name="alarm" id="opfab-signal-mapping-action" type="number"/>
              </div>
              <div *ngIf="action.invalid" class="row alert alert-danger">
                <div *ngIf="action.errors.required" translate>externalDevicesConfiguration.input.signalMapping.required</div>
              </div>
              <div class="opfab-input opfab-edit-row">
                <label for="opfab-signal-mapping-compliant" translate>shared.severity.compliant</label>
                <input formControlName="compliant" name="compliant" id="opfab-signal-mapping-compliant" type="number"/>
              </div>
              <div *ngIf="compliant.invalid" class="row alert alert-danger">
                <div *ngIf="compliant.errors.required" translate>externalDevicesConfiguration.input.signalMapping.required</div>
              </div>
              <div class="opfab-input opfab-edit-row">
                <label for="opfab-signal-mapping-information" translate>shared.severity.information</label>
                <input formControlName="information" name="information" id="opfab-signal-mapping-information" type="number"/>
              </div>
              <div *ngIf="information.invalid" class="row alert alert-danger">
                <div *ngIf="information.errors.required" translate>externalDevicesConfiguration.input.signalMapping.required</div>
              </div>
            </div>
          </div>
        </form>
        <div class="modal-footer" style="border-top: none">
          <button id="opfab-admin-edit-btn-cancel" type="button" (click)="dismissModal('Cancel click')" class="opfab-btn-cancel" data-dismiss="modal"
                  translate>admin.input.close</button>
          <button id="opfab-admin-edit-btn-add" [disabled]="!signalMappingsForm.valid" *ngIf="!row" (click)="update()" class="opfab-btn"
                  translate>externalDevicesConfiguration.input.addDevice</button>
          <button id="opfab-admin-user-btn-save" [disabled]="!signalMappingsForm.valid" *ngIf="row" (click)="update()" class="opfab-btn"
                  translate>admin.input.save</button>
        </div>
      </div>
    </div>
  </div>
</div>
